<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add Stone Product - Rajasthan SandStone Hub</title>
<link rel="icon" href="stone.png" type="image/png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* ===== General ===== */
:root {
  --primary: #c7a97b;
  --primary-dark: #a58a62;
  --secondary: #5a4a3a;
  --light: #f8f5f0;
  --dark: #333;
  --gray: #e0e0e0;
  --success: #28a745;
  --danger: #dc3545;
  --warning: #ffc107;
  --info: #17a2b8;
  --shadow: 0 4px 12px rgba(0,0,0,0.1);
  --radius: 8px;
  --transition: all 0.3s ease;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  line-height: 1.6;
  color: var(--dark);
  background: var(--light);
  min-height: 100vh;
  padding: 20px;
}

/* ===== Header ===== */
.top-header {
  background: white;
  padding: 15px 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: var(--shadow);
  border-radius: var(--radius);
  margin-bottom: 30px;
}

.header-logo {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--secondary);
}

.header-logo img {
  height: 40px;
  border-radius: 5px;
}

/* ===== Container ===== */
.container {
  max-width: 1000px;
  margin: 0 auto;
  width: 100%;
}

.page-title {
  text-align: center;
  margin-bottom: 30px;
  position: relative;
  padding-bottom: 15px;
  color: var(--secondary);
  font-size: 2rem;
}

.page-title:after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 4px;
  background: var(--primary);
}

/* ===== Form Styles ===== */
.form-container {
  background: white;
  padding: 40px;
  border-radius: 15px;
  box-shadow: var(--shadow);
  border: 1px solid var(--gray);
}

.form-group {
  margin-bottom: 25px;
}

.form-group label {
  display: block;
  margin-bottom: 10px;
  color: var(--secondary);
  font-weight: 600;
  font-size: 1rem;
}

.form-group label.required:after {
  content: " *";
  color: var(--danger);
}

.form-row {
  display: flex;
  gap: 20px;
  margin-bottom: 25px;
}

.form-col {
  flex: 1;
}

select, input, textarea {
  width: 100%;
  padding: 14px 16px;
  border-radius: var(--radius);
  border: 1px solid var(--gray);
  font-size: 1rem;
  box-sizing: border-box;
  transition: var(--transition);
  background: #fafafa;
}

select:focus, input:focus, textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(199,169,123,0.2);
  background: white;
}

.phone-input-container {
  position: relative;
}

.phone-prefix {
  position: absolute;
  left: 16px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--secondary);
  font-weight: 600;
  font-size: 1rem;
}

.phone-input {
  padding-left: 50px !important;
}

.country-code-input {
  padding-left: 80px !important;
}

.country-code-prefix {
  position: absolute;
  left: 16px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--secondary);
  font-weight: 600;
  font-size: 1rem;
  background: var(--light);
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid var(--gray);
}

.submit-btn {
  background: var(--primary);
  color: white;
  font-weight: 600;
  border: none;
  padding: 16px 32px;
  border-radius: var(--radius);
  cursor: pointer;
  font-size: 1.1rem;
  transition: var(--transition);
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  position: relative;
}

.submit-btn:hover {
  background: var(--primary-dark);
  transform: translateY(-2px);
}

.submit-btn:disabled {
  background: var(--gray);
  cursor: not-allowed;
  transform: none;
}

/* ===== Form Sections ===== */
.form-section {
  margin-bottom: 40px;
  padding-bottom: 30px;
  border-bottom: 2px solid var(--light);
}

.section-title {
  font-size: 1.4rem;
  color: var(--primary);
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 2px solid var(--primary);
  display: flex;
  align-items: center;
  gap: 10px;
}

.section-title i {
  font-size: 1.2rem;
}

/* ===== Additional Fields Section ===== */
.additional-fields-section {
  background: var(--light);
  padding: 25px;
  border-radius: var(--radius);
  margin-top: 30px;
  border: 2px dashed var(--primary);
}

.add-field-btn {
  background: var(--info);
  color: white;
  border: none;
  padding: 12px 20px;
  border-radius: var(--radius);
  cursor: pointer;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 15px;
  transition: var(--transition);
}

.add-field-btn:hover {
  background: #138496;
  transform: translateY(-2px);
}

.additional-field {
  display: flex;
  gap: 15px;
  margin-bottom: 15px;
  align-items: flex-end;
}

.field-input {
  flex: 1;
}

.remove-field-btn {
  background: var(--danger);
  color: white;
  border: none;
  padding: 12px 16px;
  border-radius: var(--radius);
  cursor: pointer;
  transition: var(--transition);
  height: fit-content;
}

.remove-field-btn:hover {
  background: #c82333;
  transform: scale(1.05);
}

/* ===== Processing Overlay ===== */
.processing-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  justify-content: center;
  align-items: center;
  z-index: 4000;
  flex-direction: column;
}

.processing-overlay.active {
  display: flex;
}

.processing-content {
  background: white;
  padding: 40px;
  border-radius: 15px;
  text-align: center;
  max-width: 400px;
  width: 90%;
  box-shadow: 0 20px 40px rgba(0,0,0,0.3);
}

.processing-spinner {
  width: 60px;
  height: 60px;
  border: 5px solid #f3f3f3;
  border-top: 5px solid var(--primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 20px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.processing-text {
  font-size: 1.2rem;
  color: var(--secondary);
  font-weight: 600;
  margin-bottom: 10px;
}

.processing-subtext {
  color: #666;
  font-size: 0.95rem;
}

/* ===== Image Upload Section ===== */
.image-upload-section {
  margin: 20px 0;
}

.upload-options {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
  flex-wrap: wrap;
}

.upload-btn {
  padding: 12px 20px;
  border: 2px dashed var(--primary);
  border-radius: var(--radius);
  background: var(--light);
  color: var(--primary);
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  min-width: 200px;
  justify-content: center;
}

.upload-btn:hover {
  background: var(--primary);
  color: white;
  border-style: solid;
}

.preview {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin: 20px 0;
  padding: 15px;
  background: var(--light);
  border-radius: var(--radius);
  min-height: 100px;
}

.preview-item {
  position: relative;
  display: inline-block;
}

.preview img {
  width: 150px;
  height: 150px;
  object-fit: cover;
  border-radius: var(--radius);
  border: 2px solid var(--gray);
  transition: var(--transition);
}

.preview img:hover {
  transform: scale(1.05);
  border-color: var(--primary);
}

.remove-image {
  position: absolute;
  top: -8px;
  right: -8px;
  background: var(--danger);
  color: white;
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  font-size: 12px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
}

.remove-image:hover {
  background: #c82333;
  transform: scale(1.1);
}

/* ===== Camera Modal ===== */
.camera-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.95);
  justify-content: center;
  align-items: center;
  z-index: 3000;
}

.camera-modal.active {
  display: flex;
}

.camera-content {
  background: transparent;
  padding: 0;
  border-radius: 0;
  width: 100%;
  height: 100%;
  max-width: 100%;
  max-height: 100%;
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.camera-preview {
  width: 100%;
  height: 100%;
  background: #000;
  border-radius: 0;
  margin-bottom: 0;
  overflow: hidden;
  position: relative;
}

#camera-video {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

#camera-canvas {
  display: none;
}

.camera-controls {
  position: absolute;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 20px;
  justify-content: center;
  align-items: center;
  z-index: 3001;
}

.camera-btn {
  padding: 15px 30px;
  border: none;
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 1.1rem;
}

.capture-btn {
  background: var(--primary);
  color: white;
  width: 200px;
  height: 200px;
  border-radius: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 5px solid white;
}

.capture-btn:hover {
  background: var(--primary-dark);
  transform: scale(1.1);
}

.cancel-btn {
  background: var(--danger);
  color: white;
  padding: 16px 30px;
  font-size: 5rem;
}

.cancel-btn:hover {
  background: #c82333;
  transform: scale(1.05);
}

.camera-close {
  position: absolute;
  top: 25px;
  right: 25px;
  font-size: 2.8rem;
  color: white;
  background: rgba(0,0,0,0.5);
  border: none;
  width: 70px;
  height: 70px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition);
  z-index: 3001;
}

.camera-close:hover {
  background: rgba(0,0,0,0.8);
  transform: scale(1.1);
}

/* ===== Footer ===== */
footer {
  background: var(--dark);
  color: white;
  text-align: center;
  padding: 20px;
  margin-top: 40px;
  border-radius: var(--radius);
  font-size: 0.95rem;
}

footer a {
  color: white;
  text-decoration: none;
  transition: var(--transition);
}

footer a:hover {
  color: var(--primary);
}

/* ===== Responsive Design ===== */
@media (max-width: 1024px) {
  .upload-options {
    flex-direction: column;
  }
  
  .upload-btn {
    min-width: 100%;
  }
  
  .additional-field {
    flex-direction: column;
    align-items: stretch;
  }
  
  .form-row {
    flex-direction: column;
    gap: 0;
  }
}

@media (max-width: 768px) {
  body {
    padding: 10px;
  }
  
  .top-header {
    padding: 12px 20px;
  }
  
  .header-logo {
    font-size: 1.3rem;
  }
  
  .container {
    padding: 0;
  }
  
  .page-title {
    font-size: 1.6rem;
    margin-bottom: 25px;
  }
  
  .form-container {
    padding: 25px;
  }
  
  .preview img {
    width: 120px;
    height: 120px;
  }
}

@media (max-width: 480px) {
  .top-header {
    padding: 10px 15px;
  }
  
  .header-logo {
    font-size: 1.2rem;
  }
  
  .page-title {
    font-size: 1.4rem;
  }
  
  .form-container {
    padding: 20px;
  }
  
  .form-group label {
    font-size: 0.9rem;
  }
  
  select, input, textarea {
    padding: 12px 14px;
    font-size: 0.9rem;
  }
  
  .preview img {
    width: 100px;
    height: 100px;
  }
  
  .submit-btn {
    padding: 14px 24px;
    font-size: 1rem;
  }
}

/* Loading and Utility Styles */
.error-message {
  color: var(--danger);
  font-size: 0.9rem;
  margin-top: 5px;
  display: none;
}

.error-message.show {
  display: block;
}

.success-message {
  color: var(--success);
  font-size: 0.9rem;
  margin-top: 5px;
  display: none;
}

.success-message.show {
  display: block;
}

.field-hint {
  color: #666;
  font-size: 0.85rem;
  margin-top: 5px;
  display: block;
}

.compulsory-note {
  text-align: center;
  color: var(--danger);
  font-size: 0.9rem;
  margin-bottom: 20px;
  font-weight: 600;
}

/* Type Select with Other Option */
.type-select-container {
  position: relative;
}

.type-other-input {
  margin-top: 10px;
  display: none;
}

/* Personal Info Warning Styles */
.personal-info-warning {
  border-color: var(--danger) !important;
  box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2) !important;
  background: #fff5f5 !important;
}

.warning-tooltip {
  position: relative;
}

.warning-tooltip::after {
  content: '⚠️ Personal details not allowed';
  position: absolute;
  bottom: -30px;
  left: 0;
  background: var(--danger);
  color: white;
  padding: 5px 10px;
  border-radius: 4px;
  font-size: 0.8rem;
  white-space: nowrap;
  z-index: 1000;
  opacity: 0;
  transition: opacity 0.3s;
}

.warning-tooltip:hover::after {
  opacity: 1;
}
</style>
</head>
<body>

<!-- ===== Top Header ===== -->
<header class="top-header">
  <div class="header-logo">
    <img src="stone.png" alt="Rajasthan Stones Logo">
    <span>Rajasthan SandStone Hub</span>
  </div>
</header>

<!-- ===== Main Container ===== -->
<div class="container">
  <h1 class="page-title">Add Stone Product</h1>
  
  <div class="compulsory-note">
    <i class="fas fa-exclamation-circle"></i> Fields marked with * are compulsory
  </div>

  <div class="form-container">
    <form id="product-form">
      <input type="hidden" id="product-id">

      <!-- ===== Basic Information Section ===== -->
      <div class="form-section">
        <h3 class="section-title"><i class="fas fa-info-circle"></i> Basic Information</h3>
        
        <div class="form-group">
          <label for="uses" class="required">Uses</label>
          <select id="uses" required>
            <option value="">Select Uses</option>
            <option value="Flooring">Flooring</option>
            <option value="Wall Cladding">Wall Cladding</option>
            <option value="Countertops">Countertops</option>
            <option value="Paving">Paving</option>
            <option value="Staircase">Staircase</option>
            <option value="Landscaping">Landscaping</option>
            <option value="Monuments">Monuments</option>
            <option value="Sculptures">Sculptures</option>
            <option value="Interior Design">Interior Design</option>
            <option value="Exterior Design">Exterior Design</option>
            <option value="Other">Other (Please specify)</option>
          </select>
          <span class="field-hint">Select the primary use of this stone product</span>
        </div>

        <div class="form-group" id="other-uses-container" style="display: none;">
          <label for="other_uses">Specify Other Uses</label>
          <input type="text" id="other_uses" placeholder="Please specify other uses">
          <span class="field-hint">Enter specific uses not listed above</span>
        </div>

        <div class="form-group">
          <label for="category" class="required">Category</label>
          <select id="category" required>
            <option value="">Select Category</option>
            <option value="Sand Stone">Sand Stone</option>
            <option value="Kota Stone">Kota Stone</option>
            <option value="Granite">Granite</option>
            <option value="Marble">Marble</option>
            <option value="Dholpur">Dholpur</option>
            <option value="Tiles">Tiles</option>
            <option value="Mandana">Mandana</option>
            <option value="Other Stones">Other Stones</option>
          </select>
          <span class="field-hint">Select the main category of your stone product</span>
        </div>

        <div class="form-group">
          <label for="stone_name" class="required">Stone Name</label>
          <input type="text" id="stone_name" placeholder="Enter stone name" required>
          <span class="field-hint">Name of the stone product (e.g., Raj Green Sandstone, White Marble, etc.)</span>
        </div>

        <div class="form-group">
          <label for="sub_category">Sub-category</label>
          <input type="text" id="sub_category" placeholder="Enter sub-category">
          <span class="field-hint">Optional: Slabs, Tiles, Blocks, etc.</span>
        </div>
      </div>

      <!-- ===== Product Details Section ===== -->
      <div class="form-section">
        <h3 class="section-title"><i class="fas fa-cube"></i> Product Details</h3>
        
        <div class="form-group type-select-container">
          <label for="type">Type</label>
          <select id="type">
            <option value="">Select Type</option>
            <option value="Natural">Natural</option>
            <option value="Calibrated">Calibrated</option>
            <option value="Polished">Polished</option>
            <option value="Honed">Honed</option>
            <option value="Brushed">Brushed</option>
            <option value="Flamed">Flamed</option>
            <option value="Tumbled">Tumbled</option>
            <option value="Other">Other (Please specify)</option>
          </select>
          <div class="type-other-input" id="type-other-container">
            <input type="text" id="type_other" placeholder="Enter custom type">
          </div>
          <span class="field-hint">Select the type of stone finish or processing</span>
        </div>

        <div class="form-row">
          <div class="form-col">
            <div class="form-group">
              <label for="color">Color</label>
              <input type="text" id="color" placeholder="Enter color">
              <span class="field-hint">Optional: Green, Brown, White, Black, etc.</span>
            </div>
          </div>
          <div class="form-col">
            <div class="form-group">
              <label for="thickness">Thickness</label>
              <input type="text" id="thickness" placeholder="Enter thickness">
              <span class="field-hint">Optional: 20-40 mm, 10-20 mm, etc.</span>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-col">
            <div class="form-group">
              <label for="length">Length</label>
              <input type="text" id="length" placeholder="Enter length">
              <span class="field-hint">Optional: In mm, cm, or feet</span>
            </div>
          </div>
          <div class="form-col">
            <div class="form-group">
              <label for="width">Width</label>
              <input type="text" id="width" placeholder="Enter width">
              <span class="field-hint">Optional: In mm, cm, or feet</span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="size">Size</label>
          <input type="text" id="size" placeholder="Enter size">
          <span class="field-hint">Optional: Custom sizes, Standard tiles, Slabs dimensions</span>
        </div>

        <div class="form-group">
          <label for="finish">Finish</label>
          <input type="text" id="finish" placeholder="Enter finish">
          <span class="field-hint">Optional: Natural, Polished, Honed, Calibrated, etc.</span>
        </div>

        <div class="form-group">
          <label for="usage">Usage</label>
          <input type="text" id="usage" placeholder="Enter usage">
          <span class="field-hint">Optional: Flooring, Wall Cladding, Countertops, etc.</span>
        </div>
      </div>

      <!-- ===== Pricing & Rate Section ===== -->
      <div class="form-section">
        <h3 class="section-title"><i class="fas fa-tag"></i> Pricing & Rate</h3>
        
        <div class="form-row">
          <div class="form-col">
            <div class="form-group">
              <label for="price">Price</label>
              <input type="number" id="price" placeholder="Enter price">
              <span class="field-hint">Optional: Price of the product</span>
            </div>
          </div>
          <div class="form-col">
            <div class="form-group">
              <label for="price_unit">Unit</label>
              <select id="price_unit">
                <option value="">Select Unit</option>
                <option value="sqft">Per Sq Ft</option>
                <option value="sqm">Per Sq M</option>
                <option value="piece">Per Piece</option>
                <option value="kg">Per Kg</option>
                <option value="ton">Per Ton</option>
                <option value="cubic">Per Cubic Ft</option>
                <option value="other">Other Unit</option>
              </select>
              <span class="field-hint">Select pricing unit</span>
            </div>
          </div>
        </div>

        <div class="form-group" id="other-unit-container" style="display: none;">
          <label for="other_unit">Specify Other Unit</label>
          <input type="text" id="other_unit" placeholder="Enter custom unit">
          <span class="field-hint">Enter unit not listed above</span>
        </div>

        <div class="form-group">
          <label for="rate_description">Rate Description</label>
          <textarea id="rate_description" placeholder="Enter detailed rate description, quantity discounts, etc." rows="3"></textarea>
          <span class="field-hint">Optional: Detailed pricing information, bulk discounts, etc.</span>
        </div>
      </div>

      <!-- ===== Technical Specifications Section ===== -->
      <div class="form-section">
        <h3 class="section-title"><i class="fas fa-flask"></i> Technical Specifications</h3>
        
        <div class="form-group">
          <label for="water_absorption">Water Absorption</label>
          <input type="text" id="water_absorption" placeholder="Enter water absorption">
          <span class="field-hint">Optional: 2-3%, 0.5-1%, etc.</span>
        </div>

        <div class="form-group">
          <label for="density">Density</label>
          <input type="text" id="density" placeholder="Enter density">
          <span class="field-hint">Optional: 2.4-2.6 g/cm³, 2.7-2.9 g/cm³, etc.</span>
        </div>

        <div class="form-group">
          <label for="compressive_strength">Compressive Strength</label>
          <input type="text" id="compressive_strength" placeholder="Enter compressive strength">
          <span class="field-hint">Optional: 1800-2200 kg/cm², 2500-3000 kg/cm², etc.</span>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" placeholder="Enter product description" rows="4"></textarea>
          <span class="field-hint">Optional: Detailed description about the stone product</span>
        </div>
      </div>

      <!-- ===== Contact Information Section ===== -->
      <div class="form-section">
        <h3 class="section-title"><i class="fas fa-address-card"></i> Contact Information</h3>
        
        <div class="form-group">
          <label for="contact_country_code" class="required">Country Code</label>
          <div class="phone-input-container">
            <span class="country-code-prefix">+</span>
            <input type="text" id="contact_country_code" class="country-code-input" placeholder="91" value="91" required maxlength="4" oninput="validateCountryCode(this)">
          </div>
          <span class="field-hint">Enter country code without + (e.g., 91 for India)</span>
        </div>

        <div class="form-group">
          <label for="contact_number" class="required">Mobile Number</label>
          <div class="phone-input-container">
            <span class="phone-prefix">+<span id="country-code-display">91</span></span>
            <input type="text" id="contact_number" class="phone-input" placeholder="Mobile Number" required maxlength="10" oninput="validatePhoneNumber(this)">
          </div>
          <span class="field-hint">Enter 10-digit mobile number without country code</span>
        </div>

        <div class="form-group">
          <label for="email" class="required">Email Address</label>
          <input type="email" id="email" placeholder="Enter email address" required>
          <span class="field-hint">Your business email address</span>
        </div>

        <div class="form-group">
          <label for="factory_name" class="required">Company / Factory Name</label>
          <input type="text" id="factory_name" placeholder="Enter company/factory name" required>
          <span class="field-hint">Name of your business or factory</span>
        </div>

        <div class="form-group">
          <label for="address" class="required">Address</label>
          <textarea id="address" placeholder="Enter complete address" rows="3" required></textarea>
          <span class="field-hint">Complete business address</span>
        </div>

        <div class="form-group">
          <label for="gst_number">GST Number</label>
          <input type="text" id="gst_number" placeholder="Enter GST number">
          <span class="field-hint">Optional: Your business GST number</span>
        </div>
      </div>

      <!-- ===== Additional Fields Section ===== -->
      <div class="additional-fields-section">
        <h3 class="section-title"><i class="fas fa-plus-circle"></i> Additional Information</h3>
        <span class="field-hint">Add any extra fields you want to include in your product listing</span>
        
        <div id="additional-fields-container">
          <!-- Additional fields will be added here dynamically -->
        </div>
        
        <button type="button" class="add-field-btn" id="add-field-btn">
          <i class="fas fa-plus"></i> Add Custom Field
        </button>
      </div>

      <!-- ===== Image Upload Section with Camera ===== -->
      <div class="form-section">
        <h3 class="section-title"><i class="fas fa-images"></i> Product Images</h3>
        
        <div class="form-group">
          <label class="required">Upload Product Images</label>
          <div class="image-upload-section">
            <div class="upload-options">
              <div class="upload-btn" onclick="document.getElementById('imageInput').click()">
                <i class="fas fa-folder-open"></i> Choose from Gallery
              </div>
              <div class="upload-btn btn-camera" id="camera-btn">
                <i class="fas fa-camera"></i> Take Photo
              </div>
              <div class="upload-btn btn-danger" id="cancel-upload">
                <i class="fas fa-times"></i> Clear All Images
              </div>
            </div>
            <input type="file" id="imageInput" accept="image/*" multiple style="display: none;">
            <small class="field-hint">Select multiple images (max 10) - You can use both gallery and camera. At least one image is required.</small>
            <div class="preview" id="preview"></div>
          </div>
        </div>
      </div>

      <button type="submit" class="submit-btn" id="submit-btn">
        <i class="fas fa-save"></i> Save Product
      </button>
    </form>
  </div>
</div>

<!-- ===== Footer ===== -->
<footer>
  &copy; 2025 Rajasthan SandStone Hub | Designed by RJ Services
</footer>

<!-- ===== Processing Overlay ===== -->
<div class="processing-overlay" id="processing-overlay">
  <div class="processing-content">
    <div class="processing-spinner"></div>
    <div class="processing-text">Processing Your Product</div>
    <div class="processing-subtext">Please wait while we save your product details...</div>
  </div>
</div>

<!-- ===== Camera Modal ===== -->
<div class="camera-modal" id="camera-modal">
  <div class="camera-content">
    <button class="camera-close" id="camera-close-btn">
      <i class="fas fa-times"></i>
    </button>
    <div class="camera-preview">
      <video id="camera-video" autoplay playsinline></video>
      <canvas id="camera-canvas"></canvas>
    </div>
    <div class="camera-controls">
      <button class="camera-btn cancel-btn" id="camera-cancel-btn">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button class="camera-btn capture-btn" id="camera-capture-btn">
        <i class="fas fa-camera"></i>
      </button>
    </div>
  </div>
</div>

<script type="module">
// CORRECTED IMPORTS - Using your firebase-config.js exports
import { 
  db, 
  auth, 
  collection, 
  addDoc, 
  doc, 
  updateDoc, 
  serverTimestamp,
  onAuthStateChanged
} from './firebase-config.js';

/* ===== Global Variables ===== */
let stream = null;
let imagesBase64 = [];
let additionalFieldsCount = 0;

/* ===== PERSONAL INFO VALIDATION - STRONG VERSION ===== */
function containsPersonalInfo(text) {
  if (!text || text.trim() === '') return false;
  
  const textLower = text.toLowerCase();
  
  // ✅ FIRST: All Units & Measurements ALLOW KARO
  const allowedUnits = [
    // Area Units
    'sqft', 'sqm', 'sqyd', 'square feet', 'square meter', 'square yard',
    // Weight Units  
    'g/cm³', 'kg/cm²', 'kg', 'gram', 'ton', 'tonne', 'pound',
    // Length Units
    'mm', 'cm', 'm', 'inch', 'feet', 'foot', 'yard',
    // Volume Units
    'liter', 'litre', 'gallon',
    // Other Units
    '%', 'percent', 'degree', 'celsius', 'fahrenheit'
  ];
  
  // Agar koi unit hai toh automatically ALLOW
  if (allowedUnits.some(unit => textLower.includes(unit))) {
    return false;
  }
  
  // ✅ SECOND: STRONG Personal info detection
  const strongPersonalPatterns = [
    // ✅ ANY Mobile number (with or without +91)
    /(\+91\s?)?[6-9]\d{9}/g,
    
    // ✅ ANY 10-digit number (potential mobile)
    /\b\d{10}\b/g,
    
    // ✅ Email addresses
    /\b\S+@\S+\.\S+\b/gi,
    
    // ✅ GST numbers
    /\b\d{2}[A-Z]{5}\d{4}[A-Z]{1}[A-Z\d]{1}[Z]{1}[A-Z\d]{1}\b/gi,
    
    // ✅ Address keywords
    /\b(address|road|street|lane|colony|area|sector|nagar|puram|ganj|chowk|marg)\b/gi,
    /\b(village|town|city|district|state|pin\s?code|pincode|zip\s?code)\b/gi,
    
    // ✅ Contact keywords
    /\b(contact|mobile|phone|whatsapp|call|email)\b/gi,
    
    // ✅ Personal names
    /\b(ravijain|ravi\s+jain|ravikumari|ravi\s+kumari)\b/gi
  ];
  
  // Check karo agar koi pattern match ho raha hai
  for (let pattern of strongPersonalPatterns) {
    const matches = text.match(pattern);
    if (matches && matches.length > 0) {
      
      // ✅ SPECIAL CASE: Agar number hai but technical context mein hai toh allow karo
      if (pattern.source.includes('\\d')) {
        const isTechnicalContext = /(\d+\s*(mm|cm|m|sqft|kg|g|%|degree))/gi.test(text);
        if (isTechnicalContext) {
          continue; // Skip karo, technical hai
        }
      }
      
      return true; // Personal info mil gaya
    }
  }
  
  return false; // Koi personal info nahi hai
}

/* ===== Real-time Personal Info Validation ===== */
function setupRealTimeValidation() {
  const productFields = [
    'stone_name', 'sub_category', 'type', 'color', 'thickness', 
    'size', 'finish', 'usage', 'water_absorption', 'density',
    'compressive_strength', 'description', 'price_unit', 'length', 'width'
  ];

  productFields.forEach(fieldName => {
    const field = document.getElementById(fieldName);
    if (field) {
      field.addEventListener('input', function() {
        if (containsPersonalInfo(this.value)) {
          this.classList.add('personal-info-warning');
          this.classList.add('warning-tooltip');
        } else {
          this.classList.remove('personal-info-warning');
          this.classList.remove('warning-tooltip');
        }
      });
    }
  });
}

/* ===== Uses Dropdown with Other Option ===== */
document.getElementById('uses').addEventListener('change', function() {
  const otherContainer = document.getElementById('other-uses-container');
  if (this.value === 'Other') {
    otherContainer.style.display = 'block';
  } else {
    otherContainer.style.display = 'none';
    document.getElementById('other_uses').value = '';
  }
});

/* ===== Type Dropdown with Other Option ===== */
document.getElementById('type').addEventListener('change', function() {
  const otherContainer = document.getElementById('type-other-container');
  if (this.value === 'Other') {
    otherContainer.style.display = 'block';
  } else {
    otherContainer.style.display = 'none';
    document.getElementById('type_other').value = '';
  }
});

/* ===== Price Unit with Other Option ===== */
document.getElementById('price_unit').addEventListener('change', function() {
  const otherContainer = document.getElementById('other-unit-container');
  if (this.value === 'other') {
    otherContainer.style.display = 'block';
  } else {
    otherContainer.style.display = 'none';
    document.getElementById('other_unit').value = '';
  }
});

/* ===== Additional Fields Functionality ===== */
document.getElementById('add-field-btn').addEventListener('click', addAdditionalField);

function addAdditionalField() {
  additionalFieldsCount++;
  const container = document.getElementById('additional-fields-container');
  const fieldId = 'additional_field_' + additionalFieldsCount;
  
  const fieldHTML = `
    <div class="additional-field" id="${fieldId}">
      <div class="field-input">
        <label>Field Name</label>
        <input type="text" placeholder="Enter field name (e.g., GST Number, Location, etc.)" class="additional-field-name">
      </div>
      <div class="field-input">
        <label>Field Value</label>
        <input type="text" placeholder="Enter field value" class="additional-field-value">
      </div>
      <button type="button" class="remove-field-btn" onclick="removeAdditionalField('${fieldId}')">
        <i class="fas fa-times"></i>
      </button>
    </div>
  `;
  
  container.insertAdjacentHTML('beforeend', fieldHTML);
}

function removeAdditionalField(fieldId) {
  const field = document.getElementById(fieldId);
  if (field) {
    field.remove();
  }
}

// Get additional fields data
function getAdditionalFieldsData() {
  const fields = [];
  const fieldElements = document.querySelectorAll('.additional-field');
  
  fieldElements.forEach(field => {
    const nameInput = field.querySelector('.additional-field-name');
    const valueInput = field.querySelector('.additional-field-value');
    
    if (nameInput.value.trim() && valueInput.value.trim()) {
      fields.push({
        name: nameInput.value.trim(),
        value: valueInput.value.trim()
      });
    }
  });
  
  return fields;
}

// Validate additional fields for personal info
function validateAdditionalFields() {
  const additionalFields = document.querySelectorAll('.additional-field');
  
  for (let field of additionalFields) {
    const nameInput = field.querySelector('.additional-field-name');
    const valueInput = field.querySelector('.additional-field-value');
    
    if (nameInput && containsPersonalInfo(nameInput.value)) {
      return { isValid: false, field: 'Additional Field Name', element: nameInput };
    }
    
    if (valueInput && containsPersonalInfo(valueInput.value)) {
      return { isValid: false, field: 'Additional Field Value', element: valueInput };
    }
  }
  
  return { isValid: true };
}

/* ===== Camera Functionality ===== */
document.getElementById('camera-btn').addEventListener('click', openCamera);
document.getElementById('camera-close-btn').addEventListener('click', closeCamera);
document.getElementById('camera-cancel-btn').addEventListener('click', closeCamera);
document.getElementById('camera-capture-btn').addEventListener('click', capturePhoto);

// Open camera function
async function openCamera() {
  const cameraModal = document.getElementById('camera-modal');
  const video = document.getElementById('camera-video');
  
  try {
    stream = await navigator.mediaDevices.getUserMedia({ 
      video: { 
        facingMode: 'environment',
        width: { ideal: 1280 },
        height: { ideal: 720 }
      } 
    });
    
    video.srcObject = stream;
    cameraModal.classList.add('active');
    document.body.style.overflow = 'hidden';
    
  } catch (err) {
    alert('Camera access denied or not available: ' + err.message);
    console.error('Camera error:', err);
  }
}

// Close camera function
function closeCamera() {
  const cameraModal = document.getElementById('camera-modal');
  
  if (stream) {
    stream.getTracks().forEach(track => track.stop());
    stream = null;
  }
  
  cameraModal.classList.remove('active');
  document.body.style.overflow = '';
}

// Capture photo function
function capturePhoto() {
  const video = document.getElementById('camera-video');
  const canvas = document.getElementById('camera-canvas');
  const context = canvas.getContext('2d');
  
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  
  context.drawImage(video, 0, 0, canvas.width, canvas.height);
  const imageDataUrl = canvas.toDataURL('image/jpeg', 0.8);
  
  addImageToPreview(imageDataUrl);
  closeCamera();
}

// Add image to preview
function addImageToPreview(imageDataUrl) {
  const preview = document.getElementById('preview');
  const imageId = 'img_' + Date.now();
  
  const previewItem = document.createElement('div');
  previewItem.className = 'preview-item';
  previewItem.id = imageId;
  previewItem.innerHTML = `
    <img src="${imageDataUrl}" alt="Product Image">
    <button type="button" class="remove-image" onclick="removeImage('${imageId}')">
      <i class="fas fa-times"></i>
    </button>
  `;
  
  preview.appendChild(previewItem);
  imagesBase64.push(imageDataUrl);
  updateFileInput();
}

// Remove image from preview
function removeImage(imageId) {
  const previewItem = document.getElementById(imageId);
  if (previewItem) {
    const img = previewItem.querySelector('img');
    const imgSrc = img.src;
    
    const index = imagesBase64.findIndex(image => image === imgSrc);
    if (index > -1) {
      imagesBase64.splice(index, 1);
    }
    
    previewItem.remove();
    
    if (imagesBase64.length === 0) {
      document.getElementById('imageInput').value = '';
    }
  }
}

// Cancel Upload Button Functionality
document.getElementById('cancel-upload').addEventListener('click', function() {
  document.getElementById('imageInput').value = '';
  document.getElementById('preview').innerHTML = '';
  imagesBase64 = [];
  updateFileInput();
});

// Update file input for validation
function updateFileInput() {
  const fileInput = document.getElementById('imageInput');
  if (imagesBase64.length > 0) {
    fileInput.setCustomValidity('');
  } else {
    fileInput.setCustomValidity('Please select at least one image');
  }
}

/* ===== Validation Functions ===== */
function validatePhoneNumber(input) {
  input.value = input.value.replace(/\D/g, '');
  if (input.value.length > 10) {
    input.value = input.value.slice(0, 10);
  }
}

function validateCountryCode(input) {
  input.value = input.value.replace(/\D/g, '');
  if (input.value.length > 4) {
    input.value = input.value.slice(0, 4);
  }
  // Update displayed country code
  document.getElementById('country-code-display').textContent = input.value || '91';
}

// Update country code display when input changes
document.getElementById('contact_country_code').addEventListener('input', function() {
  document.getElementById('country-code-display').textContent = this.value || '91';
});

/* ===== Product Form Logic ===== */
const form = document.getElementById("product-form");
const productIdInput = document.getElementById("product-id");
const preview = document.getElementById("preview");
const imageInput = document.getElementById("imageInput");
const submitBtn = document.getElementById("submit-btn");
const processingOverlay = document.getElementById("processing-overlay");

// Handle file input changes
imageInput.addEventListener("change", () => {
  const files = Array.from(imageInput.files).slice(0, 10 - imagesBase64.length);

  files.forEach(file => {
    const reader = new FileReader();
    reader.onload = (event) => {
      addImageToPreview(event.target.result);
    };
    reader.readAsDataURL(file);
  });
});

/* IMAGE UPLOAD TO WORKER */
async function uploadImages() {
  let urls = [];

  for (let img of imagesBase64) {
    try {
      const res = await fetch("https://mute-frost-eefa.ravijain236129.workers.dev", {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ base64: img })
      });

      const out = await res.json();
      if (out.status === "success") urls.push(out.url);

    } catch (e) {
      console.error("Upload Error:", e);
    }
  }
  return urls;
}

/* EDIT MODE - FOR MY HISTORY PAGE */
window.addEventListener("DOMContentLoaded", () => {
  const editId = localStorage.getItem("editProductId");
  const editData = localStorage.getItem("editProductData");

  if (editId && editData) {
    const p = JSON.parse(decodeURIComponent(editData));

    productIdInput.value = editId;
    
    // Handle uses and other uses
    if (p.uses) {
      if (['Flooring', 'Wall Cladding', 'Countertops', 'Paving', 'Staircase', 'Landscaping', 'Monuments', 'Sculptures', 'Interior Design', 'Exterior Design'].includes(p.uses)) {
        document.getElementById('uses').value = p.uses;
      } else {
        document.getElementById('uses').value = 'Other';
        document.getElementById('other-uses-container').style.display = 'block';
        document.getElementById('other_uses').value = p.uses;
      }
    }
    
    // Category remains as category
    document.getElementById('category').value = p.category || "";
    document.getElementById('stone_name').value = p.stone_name || "";
    document.getElementById('sub_category').value = p.sub_category || "";
    
    // Handle type and other type
    if (p.type) {
      if (['Natural', 'Calibrated', 'Polished', 'Honed', 'Brushed', 'Flamed', 'Tumbled'].includes(p.type)) {
        document.getElementById('type').value = p.type;
      } else {
        document.getElementById('type').value = 'Other';
        document.getElementById('type-other-container').style.display = 'block';
        document.getElementById('type_other').value = p.type;
      }
    }
    
    document.getElementById('color').value = p.color || "";
    document.getElementById('thickness').value = p.thickness || "";
    document.getElementById('length').value = p.length || "";
    document.getElementById('width').value = p.width || "";
    document.getElementById('size').value = p.size || "";
    document.getElementById('finish').value = p.finish || "";
    document.getElementById('usage').value = p.usage || "";
    document.getElementById('water_absorption').value = p.water_absorption || "";
    document.getElementById('density').value = p.density || "";
    document.getElementById('compressive_strength').value = p.compressive_strength || "";
    document.getElementById('description').value = p.description || "";
    document.getElementById('price').value = p.price || "";
    
    // Handle price unit
    if (p.price_unit) {
      if (['sqft', 'sqm', 'piece', 'kg', 'ton', 'cubic'].includes(p.price_unit)) {
        document.getElementById('price_unit').value = p.price_unit;
      } else {
        document.getElementById('price_unit').value = 'other';
        document.getElementById('other-unit-container').style.display = 'block';
        document.getElementById('other_unit').value = p.price_unit;
      }
    }
    
    document.getElementById('rate_description').value = p.rate_description || "";
    
    // Handle phone number and country code
    let phoneNumber = p.contact_number || "";
    let countryCode = "91"; // default
    
    if (phoneNumber.startsWith('+')) {
      const parts = phoneNumber.split(' ');
      if (parts.length > 1) {
        countryCode = parts[0].substring(1); // Remove +
        phoneNumber = parts[1];
      }
    }
    
    document.getElementById('contact_country_code').value = countryCode;
    document.getElementById('country-code-display').textContent = countryCode;
    document.getElementById('contact_number').value = phoneNumber;
    
    document.getElementById('email').value = p.email || "";
    document.getElementById('factory_name').value = p.factory_name || "";
    document.getElementById('address').value = p.address || "";
    document.getElementById('gst_number').value = p.gst_number || "";

    // Load additional fields
    if (p.additional_fields && p.additional_fields.length) {
      p.additional_fields.forEach(field => {
        addAdditionalField();
        const lastField = document.querySelector('.additional-field:last-child');
        if (lastField) {
          lastField.querySelector('.additional-field-name').value = field.name;
          lastField.querySelector('.additional-field-value').value = field.value;
        }
      });
    }

    // Show existing images
    if (p.images && p.images.length) {
      imagesBase64 = [];
      p.images.forEach(img => {
        addImageToPreview(img);
      });
    }
  }

  // Setup real-time validation
  setupRealTimeValidation();

  // Clear edit data after loading
  localStorage.removeItem("editProductId");
  localStorage.removeItem("editProductData");
});

/* AUTH CHECK */
onAuthStateChanged(auth, user => {
  if (!user) {
    alert("Please sign in to add products");
    window.location = "index.html";
  }
});

/* SAVE / UPDATE */
form.onsubmit = async (e) => {
  e.preventDefault();

  const user = auth.currentUser;
  if (!user) return alert("Login required");

  // ✅ PERSONAL INFO VALIDATION IN PRODUCT FIELDS
  const productFieldsToCheck = [
    { value: document.getElementById('stone_name').value, name: 'Stone Name', field: document.getElementById('stone_name') },
    { value: document.getElementById('sub_category').value, name: 'Sub-category', field: document.getElementById('sub_category') },
    { value: document.getElementById('type').value === 'Other' ? document.getElementById('type_other').value : document.getElementById('type').value, name: 'Type', field: document.getElementById('type') },
    { value: document.getElementById('color').value, name: 'Color', field: document.getElementById('color') },
    { value: document.getElementById('thickness').value, name: 'Thickness', field: document.getElementById('thickness') },
    { value: document.getElementById('size').value, name: 'Size', field: document.getElementById('size') },
    { value: document.getElementById('finish').value, name: 'Finish', field: document.getElementById('finish') },
    { value: document.getElementById('usage').value, name: 'Usage', field: document.getElementById('usage') },
    { value: document.getElementById('water_absorption').value, name: 'Water Absorption', field: document.getElementById('water_absorption') },
    { value: document.getElementById('density').value, name: 'Density', field: document.getElementById('density') },
    { value: document.getElementById('compressive_strength').value, name: 'Compressive Strength', field: document.getElementById('compressive_strength') },
    { value: document.getElementById('description').value, name: 'Description', field: document.getElementById('description') },
    { value: document.getElementById('length').value, name: 'Length', field: document.getElementById('length') },
    { value: document.getElementById('width').value, name: 'Width', field: document.getElementById('width') },
    { value: document.getElementById('rate_description').value, name: 'Rate Description', field: document.getElementById('rate_description') }
  ];

  let personalInfoFound = false;
  let problematicField = '';
  let problematicElement = null;

  for (let field of productFieldsToCheck) {
    if (field.value && containsPersonalInfo(field.value)) {
      personalInfoFound = true;
      problematicField = field.name;
      problematicElement = field.field;
      
      // Highlight problematic field
      field.field.classList.add('personal-info-warning');
      field.field.classList.add('warning-tooltip');
      
      // Scroll to problematic field
      field.field.scrollIntoView({ behavior: 'smooth', block: 'center' });
      break;
    } else {
      // Reset field styling
      field.field.classList.remove('personal-info-warning');
      field.field.classList.remove('warning-tooltip');
    }
  }

  // ✅ Additional fields validation
  const additionalValidation = validateAdditionalFields();
  if (!additionalValidation.isValid) {
    personalInfoFound = true;
    problematicField = additionalValidation.field;
    problematicElement = additionalValidation.element;
    
    problematicElement.classList.add('personal-info-warning');
    problematicElement.classList.add('warning-tooltip');
    problematicElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }

  if (personalInfoFound) {
    alert(`❌ PERSONAL DETAILS NOT ALLOWED!\n\nPlease remove personal information from "${problematicField}" field.\n\nPersonal details include:\n• Mobile numbers\n• Email addresses  \n• GST numbers\n• Address information\n• Personal names\n• Contact information`);
    return;
  }

  // Validate images
  if (imagesBase64.length === 0) {
    alert("Please add at least one product image");
    return;
  }

  // Validate phone number
  const phoneNumber = document.getElementById('contact_number').value.trim();
  if (phoneNumber.length !== 10) {
    alert("Please enter a valid 10-digit mobile number");
    return;
  }

  // Validate country code
  const countryCode = document.getElementById('contact_country_code').value.trim();
  if (!countryCode) {
    alert("Please enter a valid country code");
    return;
  }

  // Show processing overlay
  processingOverlay.classList.add('active');
  submitBtn.disabled = true;
  submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';

  try {
    // Upload images
    let imageUrls = await uploadImages();

    // Determine final values for uses, type, and price_unit
    const finalUses = document.getElementById('uses').value === 'Other' ? document.getElementById('other_uses').value : document.getElementById('uses').value;
    const finalType = document.getElementById('type').value === 'Other' ? document.getElementById('type_other').value : document.getElementById('type').value;
    const finalPriceUnit = document.getElementById('price_unit').value === 'other' ? document.getElementById('other_unit').value : document.getElementById('price_unit').value;

    const data = {
      // Basic Information - USES FIRST, then CATEGORY
      uses: finalUses,
      category: document.getElementById('category').value,
      stone_name: document.getElementById('stone_name').value,
      sub_category: document.getElementById('sub_category').value,
      
      // Product Details
      type: finalType,
      color: document.getElementById('color').value,
      thickness: document.getElementById('thickness').value,
      length: document.getElementById('length').value,
      width: document.getElementById('width').value,
      size: document.getElementById('size').value,
      finish: document.getElementById('finish').value,
      usage: document.getElementById('usage').value,
      
      // Technical Specifications
      water_absorption: document.getElementById('water_absorption').value,
      density: document.getElementById('density').value,
      compressive_strength: document.getElementById('compressive_strength').value,
      description: document.getElementById('description').value,
      
      // Pricing
      price: document.getElementById('price').value ? parseFloat(document.getElementById('price').value) : "",
      price_unit: finalPriceUnit,
      rate_description: document.getElementById('rate_description').value,
      
      // Contact Information
      contact_number: "+" + countryCode + " " + phoneNumber,
      email: document.getElementById('email').value,
      factory_name: document.getElementById('factory_name').value,
      address: document.getElementById('address').value,
      gst_number: document.getElementById('gst_number').value,
      
      // Additional Fields
      additional_fields: getAdditionalFieldsData(),
      
      // System Fields
      images: imageUrls,
      created_at: serverTimestamp(),
      userId: user.uid
    };

    const id = productIdInput.value;

    if (id) {
      await updateDoc(doc(db, "products", id), data);
    } else {
      await addDoc(collection(db, "products"), data);
    }

    // Hide processing overlay
    processingOverlay.classList.remove('active');
    
    // Show success message
    alert(id ? "Product updated successfully!" : "Product added successfully!");

    // Reset form
    form.reset();
    preview.innerHTML = "";
    imageInput.value = "";
    imagesBase64 = [];
    productIdInput.value = "";
    document.getElementById('additional-fields-container').innerHTML = "";
    additionalFieldsCount = 0;
    
    // Reset country code to default
    document.getElementById('contact_country_code').value = "91";
    document.getElementById('country-code-display').textContent = "91";

    // Hide other input containers
    document.getElementById('other-uses-container').style.display = 'none';
    document.getElementById('type-other-container').style.display = 'none';
    document.getElementById('other-unit-container').style.display = 'none';

    // Remove all personal info warnings
    document.querySelectorAll('.personal-info-warning').forEach(el => {
      el.classList.remove('personal-info-warning');
      el.classList.remove('warning-tooltip');
    });

  } catch (err) {
    // Hide processing overlay on error
    processingOverlay.classList.remove('active');
    alert("Error: " + err.message);
  } finally {
    // Reset submit button
    submitBtn.disabled = false;
    submitBtn.innerHTML = '<i class="fas fa-save"></i> Save Product';
  }
};

// Make functions available globally for onclick events
window.removeImage = removeImage;
window.removeAdditionalField = removeAdditionalField;
window.validatePhoneNumber = validatePhoneNumber;
window.validateCountryCode = validateCountryCode;
</script>

</body>
</html>
