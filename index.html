<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>RJ Services - Google Sheet CRUD</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #fafafa; }
  h1 { color: #333; }
  table { border-collapse: collapse; width: 100%; margin-top: 15px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  th { background: #f0f0f0; }
  input, button { padding: 6px; margin: 4px; }
  .edit-btn, .delete-btn { cursor: pointer; }
</style>
</head>
<body>

<h1>ðŸ“‹ RJ Services - Sheet Manager</h1>

<!-- Form -->
<div>
  <input id="company" placeholder="Company Name" />
  <input id="product" placeholder="Product" />
  <input id="type" placeholder="Product Type" />
  <input id="rate" placeholder="Rate" />
  <input id="desc" placeholder="Description" />
  <input id="contact" placeholder="Contact" />
  <input id="mail" placeholder="Mail" />
  <button onclick="addRow()">Add</button>
</div>

<!-- Table -->
<table id="dataTable">
  <thead>
    <tr>
      <th>#</th>
      <th>Company</th>
      <th>Product</th>
      <th>Type</th>
      <th>Rate</th>
      <th>Description</th>
      <th>Contact</th>
      <th>Mail</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwXYZ123abc456def/exec"; // <-- replace with your URL

// === Fetch & Display ===
async function loadData() {
  const res = await fetch(API_URL);
  const json = await res.text();
  const data = JSON.parse(json).data;
  const tbody = document.querySelector("#dataTable tbody");
  tbody.innerHTML = "";

  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${i}</td>
      <td>${row[0]}</td>
      <td>${row[1]}</td>
      <td>${row[2]}</td>
      <td>${row[3]}</td>
      <td>${row[4]}</td>
      <td>${row[5]}</td>
      <td>${row[6]}</td>
      <td>
        <button class="edit-btn" onclick="editRow(${i}, ${JSON.stringify(row).replace(/"/g, '&quot;')})">Edit</button>
        <button class="delete-btn" onclick="deleteRow(${i})">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  }
}

// === Add ===
async function addRow() {
  const row = [
    company.value, product.value, type.value, rate.value,
    desc.value, contact.value, mail.value
  ];
  await fetch(API_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ action: "add", row })
  });
  loadData();
}

// === Edit ===
async function editRow(rowIndex, oldRow) {
  const updated = [
    prompt("Company:", oldRow[0]) || oldRow[0],
    prompt("Product:", oldRow[1]) || oldRow[1],
    prompt("Type:", oldRow[2]) || oldRow[2],
    prompt("Rate:", oldRow[3]) || oldRow[3],
    prompt("Description:", oldRow[4]) || oldRow[4],
    prompt("Contact:", oldRow[5]) || oldRow[5],
    prompt("Mail:", oldRow[6]) || oldRow[6],
  ];
  await fetch(API_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ action: "edit", rowIndex, row: updated })
  });
  loadData();
}

// === Delete ===
async function deleteRow(rowIndex) {
  if (confirm("Delete this row?")) {
    await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ action: "delete", rowIndex })
    });
    loadData();
  }
}

loadData();
</script>
</body>
</html>
