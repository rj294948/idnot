<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Google Sheet CRUD</title>
</head>
<body>
  <h2>üìä Company Product Data</h2>
  <button onclick="loadData()">üîÑ Load Data</button>
  <table border="1" id="dataTable"></table>

  <script>
    const proxy = "https://api.allorigins.win/raw?url=";
    const scriptURL = "https://script.google.com/macros/s/AKfycby_H0WaVNgBZU-D0VUQs73YIXY4_OBPd-gPFoo2mTMatdg0lsQhjoRJ2uCKdLDRMse2/exec";

    async function loadData() {
      try {
        const res = await fetch(proxy + encodeURIComponent(`${scriptURL}?action=getAll`));
        const data = await res.json();
        if (!data.success) throw new Error("Failed to load");

        const table = document.getElementById("dataTable");
        table.innerHTML = "";
        let headerRow = "<tr>";
        for (const key of Object.keys(data.data[0])) headerRow += `<th>${key}</th>`;
        headerRow += "</tr>";
        table.innerHTML += headerRow;

        data.data.forEach(row => {
          let tr = "<tr>";
          for (const key in row) tr += `<td>${row[key]}</td>`;
          tr += "</tr>";
          table.innerHTML += tr;
        });
      } catch (err) {
        console.error("‚ùå Load Error:", err);
      }
    }
  </script>
</body>
</html>
