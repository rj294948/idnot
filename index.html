<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Company Product Manager</title>
<style>
  body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 20px; }
  table { width: 100%; border-collapse: collapse; background: white; margin-top: 20px; }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
  th { background: #007bff; color: white; }
  button { cursor: pointer; padding: 5px 10px; border: none; border-radius: 4px; }
  .edit-btn { background: #ffc107; }
  .delete-btn { background: #dc3545; color: white; }
  .add-btn { background: #28a745; color: white; margin-top: 10px; }
  input { padding: 6px; margin: 3px; }
</style>
</head>
<body>

<h2>üìä Company Product Data</h2>

<div id="form">
  <input id="company" placeholder="Company Name">
  <input id="product" placeholder="Product">
  <input id="type" placeholder="Product Type">
  <input id="rate" placeholder="Rate">
  <input id="desc" placeholder="Description">
  <input id="contact" placeholder="Contact">
  <input id="mail" placeholder="Mail">
  <button class="add-btn" onclick="addData()">Add</button>
</div>

<table>
  <thead>
    <tr>
      <th>Company Name</th>
      <th>Product</th>
      <th>Product Type</th>
      <th>Rate</th>
      <th>Description</th>
      <th>Contact</th>
      <th>Mail</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="dataTable"></tbody>
</table>

<script>
const API = "https://script.google.com/macros/s/AKfycby_H0WaVNgBZU-D0VUQs73YIXY4_OBPd-gPFoo2mTMatdg0lsQhjoRJ2uCKdLDRMse2/exec";

// ‚úÖ Load data from Sheet
async function loadData() {
  const res = await fetch(API);
  const json = await res.json();
  const tbody = document.getElementById("dataTable");
  tbody.innerHTML = "";
  json.data.forEach(row => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${row["company name"]}</td>
      <td>${row["product"]}</td>
      <td>${row["product type"]}</td>
      <td>${row["rate"]}</td>
      <td>${row["description"]}</td>
      <td>${row["contact"]}</td>
      <td>${row["mail"]}</td>
      <td>
        <button class="edit-btn" onclick='editRow(${row.id})'>Edit</button>
        <button class="delete-btn" onclick='deleteRow(${row.id})'>Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// ‚úÖ Add data
async function addData() {
  const body = {
    action: "add",
    "company name": document.getElementById("company").value,
    "product": document.getElementById("product").value,
    "product type": document.getElementById("type").value,
    "rate": document.getElementById("rate").value,
    "description": document.getElementById("desc").value,
    "contact": document.getElementById("contact").value,
    "mail": document.getElementById("mail").value
  };

  await fetch(API, {
    method: "POST",
    body: JSON.stringify(body),
  });
  alert("‚úÖ Data Added!");
  loadData();
}

// ‚úÖ Edit data (prompt user)
async function editRow(id) {
  const company = prompt("Enter new Company Name:");
  const product = prompt("Enter new Product:");
  const type = prompt("Enter new Product Type:");
  const rate = prompt("Enter new Rate:");
  const desc = prompt("Enter new Description:");
  const contact = prompt("Enter new Contact:");
  const mail = prompt("Enter new Mail:");

  const body = {
    action: "edit", id,
    "company name": company,
    "product": product,
    "product type": type,
    "rate": rate,
    "description": desc,
    "contact": contact,
    "mail": mail
  };

  await fetch(API, { method: "POST", body: JSON.stringify(body) });
  alert("‚úèÔ∏è Row Updated!");
  loadData();
}

// ‚úÖ Delete row
async function deleteRow(id) {
  if (confirm("Are you sure to delete this row?")) {
    await fetch(API, { method: "POST", body: JSON.stringify({ action: "delete", id }) });
    alert("üóëÔ∏è Row Deleted!");
    loadData();
  }
}

// Load when page opens
loadData();
</script>
</body>
</html>
