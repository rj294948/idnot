<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RJ Sheet Data Manager</title>
<style>
body {
  font-family: Arial, sans-serif;
  margin: 20px;
  background: #f8f9fa;
}
h1 {
  color: #333;
}
button {
  background: #007bff;
  color: #fff;
  padding: 8px 12px;
  border: none;
  cursor: pointer;
  border-radius: 5px;
}
button:hover {
  background: #0056b3;
}
table {
  border-collapse: collapse;
  width: 100%;
  margin-top: 20px;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: left;
}
th {
  background: #007bff;
  color: white;
}
</style>
</head>
<body>
<h1>Google Sheet Data Management</h1>

<button onclick="loadData()">ðŸ”„ Load Data</button>

<table id="dataTable">
  <thead>
    <tr>
      <th>ID</th>
      <th>Company Name</th>
      <th>Product</th>
      <th>Type</th>
      <th>Rate</th>
      <th>Description</th>
      <th>Contact</th>
      <th>Mail</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxCKvJbupBHfYu1jAgrmyWQ7EFQVUnZRKVS2Y7GLkb7wWvn5l4h5nDjGwiti5tHIkOE/exec";

async function loadData() {
  try {
    const res = await fetch(`${API_URL}?action=getData`);
    const json = await res.json();

    if (!json.success) throw new Error(json.error || "Failed to load");

    const tbody = document.querySelector("#dataTable tbody");
    tbody.innerHTML = "";

    json.data.forEach(row => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${row.ID || ""}</td>
        <td>${row["Company Name"] || ""}</td>
        <td>${row.Product || ""}</td>
        <td>${row["Product Type"] || ""}</td>
        <td>${row.Rate || ""}</td>
        <td>${row.Description || ""}</td>
        <td>${row.Contact || ""}</td>
        <td>${row.Mail || ""}</td>`;
      tbody.appendChild(tr);
    });
  } catch (err) {
    console.error("Error:", err);
    alert("CORS or API issue: " + err.message);
  }
}

loadData();
</script>
</body>
</html>
