<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RJ Sheet CRUD</title>
<style>
body { font-family: Arial; margin: 20px; background: #f8f9fa; }
table { border-collapse: collapse; width: 100%; background: white; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
th { background: #007bff; color: white; }
button { margin: 4px; padding: 6px 10px; cursor: pointer; }
input { margin: 5px; padding: 5px; width: 200px; }
</style>
</head>
<body>

<h2>üìã RJ Product Data</h2>

<div>
  <input id="company" placeholder="Company Name">
  <input id="product" placeholder="Product">
  <input id="ptype" placeholder="Product Type">
  <input id="rate" placeholder="Rate">
  <input id="desc" placeholder="Description">
  <input id="contact" placeholder="Contact">
  <input id="mail" placeholder="Mail">
  <button onclick="addData()">Add</button>
</div>

<table id="dataTable">
  <thead>
    <tr>
      <th>Company Name</th>
      <th>Product</th>
      <th>Product Type</th>
      <th>Rate</th>
      <th>Description</th>
      <th>Contact</th>
      <th>Mail</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycby_H0WaVNgBZU-D0VUQs73YIXY4_OBPd-gPFoo2mTMatdg0lsQhjoRJ2uCKdLDRMse2/exec";

async function loadData() {
  try {
    const res = await fetch(`${API_URL}?action=getAll`);
    const data = await res.json();
    const tbody = document.querySelector("#dataTable tbody");
    tbody.innerHTML = "";
    data.forEach(r => {
      tbody.innerHTML += `
        <tr>
          <td>${r["company name"]}</td>
          <td>${r["product"]}</td>
          <td>${r["product type"]}</td>
          <td>${r["rate"]}</td>
          <td>${r["description"]}</td>
          <td>${r["contact"]}</td>
          <td>${r["mail"]}</td>
          <td>
            <button onclick='editRow("${r["company name"]}")'>‚úèÔ∏è Edit</button>
            <button onclick='deleteRow("${r["company name"]}")'>üóëÔ∏è Delete</button>
          </td>
        </tr>`;
    });
  } catch (err) {
    console.error("‚ùå Load Error:", err);
  }
}

async function addData() {
  const data = {
    action: "add",
    "company name": company.value,
    product: product.value,
    "product type": ptype.value,
    rate: rate.value,
    description: desc.value,
    contact: contact.value,
    mail: mail.value
  };
  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify(data),
    headers: { "Content-Type": "application/json" }
  });
  loadData();
}

async function editRow(name) {
  const data = {
    action: "edit",
    "company name": name,
    product: prompt("New product?"),
    "product type": prompt("New product type?"),
    rate: prompt("New rate?"),
    description: prompt("New description?"),
    contact: prompt("New contact?"),
    mail: prompt("New mail?")
  };
  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify(data),
    headers: { "Content-Type": "application/json" }
  });
  loadData();
}

async function deleteRow(name) {
  if (!confirm("Delete this row?")) return;
  const data = { action: "delete", "company name": name };
  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify(data),
    headers: { "Content-Type": "application/json" }
  });
  loadData();
}

loadData();
</script>
</body>
</html>
